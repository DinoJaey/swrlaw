---
import logo from '../assets/logos/swr_logo.png';

const base = import.meta.env.BASE_URL || '/';

const attorneys = [
  { label: 'Tailim Song', href: 'attorneys/tailim-song' },
  { label: 'Jordan Whiddon', href: 'attorneys/jordan-whiddon' },
  { label: 'Daniel Rowland', href: 'attorneys/daniel-rowland' },
  { label: 'Vrinda Bhuta', href: 'attorneys/vrinda-bhuta' },
  { label: "Xinyan 'George' Zhou", href: 'attorneys/george-zhou' },
  { label: "Heng Sun 'Andy' Cho", href: 'attorneys/andy-cho' }
];

const staff = [
  { label: 'Yuliana Ramirez', href: 'staff/yuliana-ramirez' },
  { label: 'Riley Fountain', href: 'staff/riley-fountain' },
  { label: 'Malia Wong', href: 'staff/malia-wong' },
  { label: 'David Cho', href: 'staff/david-cho' }
];

const navLinks = [
  { href: '', label: 'Home' },
  { href: 'about', label: 'About' },
  { href: 'legal', label: 'Legal' },
  { href: 'practice', label: 'Practice' },
  { href: 'attorneys', label: 'Attorneys', children: attorneys },
  { href: 'staff', label: 'Staff', children: staff },
  { href: 'contact', label: 'Contact' }
];
---

<header class="sticky top-0 z-40 w-full border-b border-slate-200 bg-white/95 backdrop-blur">
  <div class="mx-auto flex max-w-6xl items-center justify-between px-6 py-6 lg:px-8">
    <a href={base} class="flex items-center gap-3" aria-label="SWR Law home">
      <img src={logo.src} alt="SWR Law logo" class="h-14 w-auto" />
    </a>

  <nav class="hidden items-center gap-3 text-base font-semibold text-slate-700 md:flex">
      {navLinks.map((item) => (
        <div class="group relative flex h-full items-center focus-within:outline-none">
          <a
            href={`${base}${item.href}`}
            class="flex items-center gap-2 rounded-full px-5 py-3 transition-all duration-200 hover:bg-slate-100 hover:text-slate-900 focus:bg-slate-100 focus:text-slate-900"
            aria-haspopup={item.children ? 'true' : 'false'}
            aria-expanded={item.children ? 'false' : 'false'}
          >
            {item.label}
            {/* Chevron (Only visible if it has children) */}
            {item.children && (
              <svg 
                xmlns="http://www.w3.org/2000/svg" 
                viewBox="0 0 20 20" 
                fill="currentColor" 
                class="h-4 w-4 text-slate-400 transition-transform duration-200 group-hover:rotate-180 group-hover:text-slate-900"
              >
                <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd" />
              </svg>
            )}
          </a>

          {item.children && (
            /* Dropdown Container */
            <div class="pointer-events-none absolute left-1/2 top-full z-50 min-w-[16rem] -translate-x-1/2 pt-3 opacity-0 transition-opacity duration-200 ease-in-out group-hover:pointer-events-auto group-hover:opacity-100 group-focus-within:pointer-events-auto group-focus-within:opacity-100">
              
              {/* The White Box */}
              <div class="overflow-hidden rounded-xl border border-slate-100 bg-white shadow-xl p-2">
                {item.children.map((child) => (
                  <a
                    href={`${base}${child.href}`}
                    class="block px-4 py-3 text-base text-slate-600 transition-all hover:bg-slate-200 hover:text-slate-900"
                  >
                    {child.label}
                  </a>
                ))}
              </div>
            </div>
          )}
        </div>
      ))}
    </nav>

    <div class="hidden items-center gap-4 md:flex">
      <a
        href={`${base}contact`}
        class="rounded-full bg-slate-900 px-5 py-3 text-base font-semibold text-white shadow-sm transition hover:bg-slate-800"
      >
        Book a consult
      </a>
    </div>

    <button
      type="button"
      class="inline-flex h-12 w-12 items-center justify-center rounded-md border border-slate-200 text-slate-700 shadow-sm transition hover:border-slate-900 md:hidden"
      aria-label="Toggle navigation"
      aria-expanded="false"
      data-menu-toggle
    >
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7h16M4 12h16M4 17h16" />
      </svg>
    </button>
  </div>

    <div class="hidden border-t border-slate-200 bg-white md:hidden" data-mobile-menu>
      <div class="mx-auto flex max-w-6xl flex-col gap-1 px-4 py-3 text-sm font-semibold text-slate-800">
        {navLinks.map((item) => (
          item.children ? (
            <details class="rounded-md border border-slate-100">
              <summary class="flex cursor-pointer items-center justify-between px-3 py-2 hover:bg-slate-50">
                <span>{item.label}</span>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 9l6 6 6-6" />
                </svg>
              </summary>
              <div class="flex flex-col px-3 pb-2">
                {item.children.map((child) => (
                  <a
                    href={`${base}${child.href}`}
                    class="px-2 py-2 text-sm font-medium text-slate-700 transition hover:bg-slate-200"
                  >
                    {child.label}
                  </a>
                ))}
              </div>
            </details>
          ) : (
            <a
              href={`${base}${item.href}`}
              class="rounded-md px-3 py-2 transition hover:bg-slate-100"
            >
              {item.label}
            </a>
          )
        ))}
        <div class="flex flex-wrap gap-2 pt-2">
          <a
            href={`${base}contact`}
            class="flex-1 rounded-md bg-slate-900 px-3 py-2 text-center text-white transition hover:bg-slate-800"
          >
            Book a consult
          </a>
        </div>
      </div>
    </div>
</header>

<script>
  const toggle = document.querySelector('[data-menu-toggle]');
  const menu = document.querySelector('[data-mobile-menu]');

  toggle?.addEventListener('click', () => {
    menu?.classList.toggle('hidden');
    const expanded = !menu?.classList.contains('hidden');
    toggle.setAttribute('aria-expanded', expanded ? 'true' : 'false');
  });
</script>
